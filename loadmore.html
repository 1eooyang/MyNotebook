<!DOCTYPE HTML>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="Keywords" content="blog"/>
    <meta name="Description" content="blog"/>
    <title>Simple</title>
    <link rel="shortcut icon" href="/static/favicon.png"/>
    <link rel="stylesheet" type="text/css" href="/main.css" />
</head>
<body>
<div class="main">
    <div class="header">
    	<ul id="pages">
            <li><a href="/">home</a></li>
            <li><a href="/#/tags">tags</a></li>
            <li><a href="/#/archive">archive</a></li>
    	</ul>
    </div>
	<div class="wrap-header">
	<h1>
    <a href="/" id="title"></a>
	</h1>
	</div>
<div id="md" style="display: none;">
<!-- markdown -->
##<center>android下拉刷新，加载更多</center>
我们经常看到一些app中的listview下拉可以自动刷新，继续向上滚动可以自动加载更多。这在很多app中有很广泛的应用，尤其当下很多APP都以内容为主导。
github上有很多这种框架，我们选择采用这个[https://github.com/liaohuqiu/android-Ultra-Pull-To-Refresh](https://github.com/liaohuqiu/android-Ultra-Pull-To-Refresh)
然后我们就可以开始使用这个框架了。
~~~~{java}
package com.bboylin.sportsmeeting.Fragments;

import android.os.AsyncTask;
import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ListView;

import com.bboylin.sportsmeeting.Adapter.NewsAdapter;
import com.bboylin.sportsmeeting.Item.DataItemBiz;
import com.bboylin.sportsmeeting.Item.NewsItem;
import com.bboylin.sportsmeeting.R;

import java.util.ArrayList;
import java.util.List;

import in.srain.cube.views.loadmore.LoadMoreContainer;
import in.srain.cube.views.loadmore.LoadMoreHandler;
import in.srain.cube.views.loadmore.LoadMoreListViewContainer;
import in.srain.cube.views.ptr.PtrDefaultHandler;
import in.srain.cube.views.ptr.PtrFrameLayout;
import in.srain.cube.views.ptr.PtrHandler;

/**
 * Created by lin on 2016/4/3.
 */
public class NewsFragment extends Fragment{
    //下拉刷新
    private PtrFrameLayout newsFrame;
    //加载更多
    private LoadMoreListViewContainer newsLoadMoreListViewContainer;
    private ListView newslistView;
    private NewsAdapter mAdapter;
    private List<NewsItem> mNewsList;
    private int currentPage=1;
    public static final String NewsUrl=
            "http://2015.eeyes.net/2015_athletic_meeting/index.php?m=News&c=Index&a=news&page=";



    public NewsFragment(){
        mNewsList=new ArrayList<>();
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {

        View view=inflater.inflate(R.layout.news_fragment,container,false);
        newsFrame = (PtrFrameLayout) view.findViewById(R.id.ptr_news_frame);
        newsLoadMoreListViewContainer= (LoadMoreListViewContainer) view.findViewById(R.id.news_load_more_list_view_container);
        newslistView= (ListView) view.findViewById(R.id.news_listview);

        mAdapter=new NewsAdapter(this.getActivity(),mNewsList);
        newslistView.setAdapter(mAdapter);
        getNews(1);
        newsFrame.setLoadingMinTime(1000);//至少加载一秒
        newsFrame.setDurationToCloseHeader(300);
        newsFrame.setPtrHandler(new PtrHandler() {
            @Override
            public boolean checkCanDoRefresh(PtrFrameLayout frame, View content, View header) {
                return PtrDefaultHandler.checkContentCanBePulledDown(frame, newslistView, header);
            }

            @Override
            public void onRefreshBegin(PtrFrameLayout frame) {//刷新操作
                currentPage = 1;
                getNews(currentPage);
            }
        });
        newsLoadMoreListViewContainer.useDefaultHeader();
        newsLoadMoreListViewContainer.setLoadMoreHandler(new LoadMoreHandler() {
            @Override
            public void onLoadMore(LoadMoreContainer loadMoreContainer) {//加载更多
                LoadNewsList loadNewsList = new LoadNewsList();
                currentPage++;
                loadNewsList.execute(currentPage);
            }
        });

        return view;
    }

    private void getNews(int currentPage) {
        if(mNewsList.size()>0){
            mNewsList.clear();
        }
        LoadNewsList loadNewsList=new LoadNewsList();
        loadNewsList.execute(currentPage);
    }

    public class LoadNewsList extends AsyncTask<Integer,Integer,List<NewsItem>> {//异步加载
        @Override
        protected List<NewsItem> doInBackground(Integer... params) {
            List<NewsItem> list=new ArrayList<>();
            list= DataItemBiz.getNewsItem(params[0],NewsUrl);
            return list;
        }

        @Override
        protected void onPostExecute(List<NewsItem> list) {
            for(int i=0;i<list.size();++i){
                mNewsList.add(list.get(i));
            }
            mAdapter.notifyDataSetChanged();
            newsFrame.refreshComplete();
            newsLoadMoreListViewContainer.loadMoreFinish(false,true);//加载结果不为空，而且可以继续加载
        }
    }

}
~~~~
下面是一个利用jsoup库爬取网页内容作为数据提供给刷新和加载更多用的。
~~~~{java}
package com.bboylin.sportsmeeting.Item;


import android.content.Context;

import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.jsoup.select.Elements;

import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

/**
 * Created by lin on 2016/4/16.
 * get data of news and result
 */
public class DataItemBiz {
    Context context;

    public DataItemBiz(Context context){
        this.context=context;
    }

    public static List<NewsItem> getNewsItem(Integer page,String urlAddress){
        List<NewsItem> list=new ArrayList<>();
        String currentUrl=urlAddress + page;
        try {
            Document document=Jsoup.connect(currentUrl).get();
            Element element=document.select("div.content").first();
            Elements title=element.select("a[href]");
            Elements time=element.select("span");
            for(int i=0;i<title.size()&i<time.size();++i){
                NewsItem newsItem=new NewsItem();
                newsItem.setNewsid(i);
                newsItem.setNewsLink(title.get(i).attr("abs:href"));
                newsItem.setNewstitle(title.get(i).text());
                newsItem.setNewspagenumber(i / 20 + 1);
                newsItem.setNewstime(time.get(i).text());
                list.add(newsItem);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }

        return list;
    }
}
~~~~

更多博客尽在：[bboylin.com](http://bboylin.com)

<!-- markdown end -->
</div>
<div class="entry" id="main">
<!-- content -->
<h2 id="centerandroidcenter"><center>android下拉刷新，加载更多</center></h2>

<p>我们经常看到一些app中的listview下拉可以自动刷新，继续向上滚动可以自动加载更多。这在很多app中有很广泛的应用，尤其当下很多APP都以内容为主导。
github上有很多这种框架，我们选择采用这个<a href="https://github.com/liaohuqiu/android-Ultra-Pull-To-Refresh">https://github.com/liaohuqiu/android-Ultra-Pull-To-Refresh</a>
然后我们就可以开始使用这个框架了。</p>

<pre class=" language-java"><code class=" language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>bboylin<span class="token punctuation">.</span>sportsmeeting<span class="token punctuation">.</span>Fragments<span class="token punctuation">;</span>

<span class="token keyword">import</span> android<span class="token punctuation">.</span>os<span class="token punctuation">.</span>AsyncTask<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>os<span class="token punctuation">.</span>Bundle<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>support<span class="token punctuation">.</span>v4<span class="token punctuation">.</span>app<span class="token punctuation">.</span>Fragment<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>view<span class="token punctuation">.</span>LayoutInflater<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>view<span class="token punctuation">.</span>View<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>view<span class="token punctuation">.</span>ViewGroup<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>widget<span class="token punctuation">.</span>ListView<span class="token punctuation">;</span>

<span class="token keyword">import</span> com<span class="token punctuation">.</span>bboylin<span class="token punctuation">.</span>sportsmeeting<span class="token punctuation">.</span>Adapter<span class="token punctuation">.</span>NewsAdapter<span class="token punctuation">;</span>
<span class="token keyword">import</span> com<span class="token punctuation">.</span>bboylin<span class="token punctuation">.</span>sportsmeeting<span class="token punctuation">.</span>Item<span class="token punctuation">.</span>DataItemBiz<span class="token punctuation">;</span>
<span class="token keyword">import</span> com<span class="token punctuation">.</span>bboylin<span class="token punctuation">.</span>sportsmeeting<span class="token punctuation">.</span>Item<span class="token punctuation">.</span>NewsItem<span class="token punctuation">;</span>
<span class="token keyword">import</span> com<span class="token punctuation">.</span>bboylin<span class="token punctuation">.</span>sportsmeeting<span class="token punctuation">.</span>R<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>ArrayList<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>List<span class="token punctuation">;</span>

<span class="token keyword">import</span> in<span class="token punctuation">.</span>srain<span class="token punctuation">.</span>cube<span class="token punctuation">.</span>views<span class="token punctuation">.</span>loadmore<span class="token punctuation">.</span>LoadMoreContainer<span class="token punctuation">;</span>
<span class="token keyword">import</span> in<span class="token punctuation">.</span>srain<span class="token punctuation">.</span>cube<span class="token punctuation">.</span>views<span class="token punctuation">.</span>loadmore<span class="token punctuation">.</span>LoadMoreHandler<span class="token punctuation">;</span>
<span class="token keyword">import</span> in<span class="token punctuation">.</span>srain<span class="token punctuation">.</span>cube<span class="token punctuation">.</span>views<span class="token punctuation">.</span>loadmore<span class="token punctuation">.</span>LoadMoreListViewContainer<span class="token punctuation">;</span>
<span class="token keyword">import</span> in<span class="token punctuation">.</span>srain<span class="token punctuation">.</span>cube<span class="token punctuation">.</span>views<span class="token punctuation">.</span>ptr<span class="token punctuation">.</span>PtrDefaultHandler<span class="token punctuation">;</span>
<span class="token keyword">import</span> in<span class="token punctuation">.</span>srain<span class="token punctuation">.</span>cube<span class="token punctuation">.</span>views<span class="token punctuation">.</span>ptr<span class="token punctuation">.</span>PtrFrameLayout<span class="token punctuation">;</span>
<span class="token keyword">import</span> in<span class="token punctuation">.</span>srain<span class="token punctuation">.</span>cube<span class="token punctuation">.</span>views<span class="token punctuation">.</span>ptr<span class="token punctuation">.</span>PtrHandler<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * Created by lin on 2016/4/3.
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NewsFragment</span> <span class="token keyword">extends</span> <span class="token class-name">Fragment</span><span class="token punctuation">{</span>
   <span class="token comment" spellcheck="true"> //下拉刷新
</span>    <span class="token keyword">private</span> PtrFrameLayout newsFrame<span class="token punctuation">;</span>
   <span class="token comment" spellcheck="true"> //加载更多
</span>    <span class="token keyword">private</span> LoadMoreListViewContainer newsLoadMoreListViewContainer<span class="token punctuation">;</span>
    <span class="token keyword">private</span> ListView newslistView<span class="token punctuation">;</span>
    <span class="token keyword">private</span> NewsAdapter mAdapter<span class="token punctuation">;</span>
    <span class="token keyword">private</span> List<span class="token operator">&lt;</span>NewsItem&gt; mNewsList<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> currentPage<span class="token number">=1</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> String NewsUrl<span class="token operator">=</span>
            <span class="token string">"http://2015.eeyes.net/2015_athletic_meeting/index.php?m=News&amp;c=Index&amp;a=news&amp;page="</span><span class="token punctuation">;</span>



    <span class="token keyword">public</span> <span class="token function">NewsFragment<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        mNewsList<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span>&gt;<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    @Override
    <span class="token keyword">public</span> View <span class="token function">onCreateView<span class="token punctuation">(</span></span>LayoutInflater inflater<span class="token punctuation">,</span> ViewGroup container<span class="token punctuation">,</span> Bundle savedInstanceState<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        View view<span class="token operator">=</span>inflater<span class="token punctuation">.</span><span class="token function">inflate<span class="token punctuation">(</span></span>R<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>news_fragment<span class="token punctuation">,</span>container<span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        newsFrame <span class="token operator">=</span> <span class="token punctuation">(</span>PtrFrameLayout<span class="token punctuation">)</span> view<span class="token punctuation">.</span><span class="token function">findViewById<span class="token punctuation">(</span></span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>ptr_news_frame<span class="token punctuation">)</span><span class="token punctuation">;</span>
        newsLoadMoreListViewContainer<span class="token operator">=</span> <span class="token punctuation">(</span>LoadMoreListViewContainer<span class="token punctuation">)</span> view<span class="token punctuation">.</span><span class="token function">findViewById<span class="token punctuation">(</span></span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>news_load_more_list_view_container<span class="token punctuation">)</span><span class="token punctuation">;</span>
        newslistView<span class="token operator">=</span> <span class="token punctuation">(</span>ListView<span class="token punctuation">)</span> view<span class="token punctuation">.</span><span class="token function">findViewById<span class="token punctuation">(</span></span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>news_listview<span class="token punctuation">)</span><span class="token punctuation">;</span>

        mAdapter<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">NewsAdapter</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getActivity<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>mNewsList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        newslistView<span class="token punctuation">.</span><span class="token function">setAdapter<span class="token punctuation">(</span></span>mAdapter<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">getNews<span class="token punctuation">(</span></span>1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        newsFrame<span class="token punctuation">.</span><span class="token function">setLoadingMinTime<span class="token punctuation">(</span></span>1000<span class="token punctuation">)</span><span class="token comment" spellcheck="true">;//至少加载一秒
</span>        newsFrame<span class="token punctuation">.</span><span class="token function">setDurationToCloseHeader<span class="token punctuation">(</span></span>300<span class="token punctuation">)</span><span class="token punctuation">;</span>
        newsFrame<span class="token punctuation">.</span><span class="token function">setPtrHandler<span class="token punctuation">(</span></span><span class="token keyword">new</span> <span class="token class-name">PtrHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            @Override
            <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">checkCanDoRefresh<span class="token punctuation">(</span></span>PtrFrameLayout frame<span class="token punctuation">,</span> View content<span class="token punctuation">,</span> View header<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> PtrDefaultHandler<span class="token punctuation">.</span><span class="token function">checkContentCanBePulledDown<span class="token punctuation">(</span></span>frame<span class="token punctuation">,</span> newslistView<span class="token punctuation">,</span> header<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            @Override
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onRefreshBegin<span class="token punctuation">(</span></span>PtrFrameLayout frame<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">{//刷新操作
</span>                currentPage <span class="token operator">=</span><span class="token number"> 1</span><span class="token punctuation">;</span>
                <span class="token function">getNews<span class="token punctuation">(</span></span>currentPage<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        newsLoadMoreListViewContainer<span class="token punctuation">.</span><span class="token function">useDefaultHeader<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        newsLoadMoreListViewContainer<span class="token punctuation">.</span><span class="token function">setLoadMoreHandler<span class="token punctuation">(</span></span><span class="token keyword">new</span> <span class="token class-name">LoadMoreHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            @Override
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onLoadMore<span class="token punctuation">(</span></span>LoadMoreContainer loadMoreContainer<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">{//加载更多
</span>                LoadNewsList loadNewsList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LoadNewsList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                currentPage<span class="token operator">++</span><span class="token punctuation">;</span>
                loadNewsList<span class="token punctuation">.</span><span class="token function">execute<span class="token punctuation">(</span></span>currentPage<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> view<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">getNews<span class="token punctuation">(</span></span><span class="token keyword">int</span> currentPage<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>mNewsList<span class="token punctuation">.</span><span class="token function">size<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token number">&gt;0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            mNewsList<span class="token punctuation">.</span><span class="token function">clear<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        LoadNewsList loadNewsList<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">LoadNewsList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        loadNewsList<span class="token punctuation">.</span><span class="token function">execute<span class="token punctuation">(</span></span>currentPage<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LoadNewsList</span> <span class="token keyword">extends</span> <span class="token class-name">AsyncTask</span><span class="token operator">&lt;</span>Integer<span class="token punctuation">,</span>Integer<span class="token punctuation">,</span>List<span class="token operator">&lt;</span>NewsItem&gt;&gt; <span class="token comment" spellcheck="true">{//异步加载
</span>        @Override
        <span class="token keyword">protected</span> List<span class="token operator">&lt;</span>NewsItem&gt; <span class="token function">doInBackground<span class="token punctuation">(</span></span>Integer<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            List<span class="token operator">&lt;</span>NewsItem&gt; list<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span>&gt;<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            list<span class="token operator">=</span> DataItemBiz<span class="token punctuation">.</span><span class="token function">getNewsItem<span class="token punctuation">(</span></span>params<span class="token number">[0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>NewsUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> list<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        @Override
        <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onPostExecute<span class="token punctuation">(</span></span>List<span class="token operator">&lt;</span>NewsItem&gt; list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token number">=0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>list<span class="token punctuation">.</span><span class="token function">size<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span>
                mNewsList<span class="token punctuation">.</span><span class="token function">add<span class="token punctuation">(</span></span>list<span class="token punctuation">.</span><span class="token function">get<span class="token punctuation">(</span></span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            mAdapter<span class="token punctuation">.</span><span class="token function">notifyDataSetChanged<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            newsFrame<span class="token punctuation">.</span><span class="token function">refreshComplete<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            newsLoadMoreListViewContainer<span class="token punctuation">.</span><span class="token function">loadMoreFinish<span class="token punctuation">(</span></span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">;//加载结果不为空，而且可以继续加载
</span>        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre>下面是一个利用jsoup库爬取网页内容作为数据提供给刷新和加载更多用的。
<pre class=" language-java"><code class=" language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>bboylin<span class="token punctuation">.</span>sportsmeeting<span class="token punctuation">.</span>Item<span class="token punctuation">;</span>


<span class="token keyword">import</span> android<span class="token punctuation">.</span>content<span class="token punctuation">.</span>Context<span class="token punctuation">;</span>

<span class="token keyword">import</span> org<span class="token punctuation">.</span>jsoup<span class="token punctuation">.</span>Jsoup<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>jsoup<span class="token punctuation">.</span>nodes<span class="token punctuation">.</span>Document<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>jsoup<span class="token punctuation">.</span>nodes<span class="token punctuation">.</span>Element<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>jsoup<span class="token punctuation">.</span>select<span class="token punctuation">.</span>Elements<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>IOException<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>ArrayList<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>List<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * Created by lin on 2016/4/16.
 * get data of news and result
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DataItemBiz</span> <span class="token punctuation">{</span>
    Context context<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token function">DataItemBiz<span class="token punctuation">(</span></span>Context context<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token operator">=</span>context<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> List<span class="token operator">&lt;</span>NewsItem&gt; <span class="token function">getNewsItem<span class="token punctuation">(</span></span>Integer page<span class="token punctuation">,</span>String urlAddress<span class="token punctuation">)</span><span class="token punctuation">{</span>
        List<span class="token operator">&lt;</span>NewsItem&gt; list<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span>&gt;<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        String currentUrl<span class="token operator">=</span>urlAddress <span class="token operator">+</span> page<span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            Document document<span class="token operator">=</span>Jsoup<span class="token punctuation">.</span><span class="token function">connect<span class="token punctuation">(</span></span>currentUrl<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            Element element<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token function">select<span class="token punctuation">(</span></span><span class="token string">"div.content"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">first<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            Elements title<span class="token operator">=</span>element<span class="token punctuation">.</span><span class="token function">select<span class="token punctuation">(</span></span><span class="token string">"a[href]"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            Elements time<span class="token operator">=</span>element<span class="token punctuation">.</span><span class="token function">select<span class="token punctuation">(</span></span><span class="token string">"span"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token number">=0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>title<span class="token punctuation">.</span><span class="token function">size<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token operator">&amp;</span>i<span class="token operator">&lt;</span>time<span class="token punctuation">.</span><span class="token function">size<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">{</span>
                NewsItem newsItem<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">NewsItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                newsItem<span class="token punctuation">.</span><span class="token function">setNewsid<span class="token punctuation">(</span></span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
                newsItem<span class="token punctuation">.</span><span class="token function">setNewsLink<span class="token punctuation">(</span></span>title<span class="token punctuation">.</span><span class="token function">get<span class="token punctuation">(</span></span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr<span class="token punctuation">(</span></span><span class="token string">"abs:href"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                newsItem<span class="token punctuation">.</span><span class="token function">setNewstitle<span class="token punctuation">(</span></span>title<span class="token punctuation">.</span><span class="token function">get<span class="token punctuation">(</span></span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                newsItem<span class="token punctuation">.</span><span class="token function">setNewspagenumber<span class="token punctuation">(</span></span>i <span class="token operator">/</span><span class="token number"> 20</span> <span class="token operator">+</span><span class="token number"> 1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                newsItem<span class="token punctuation">.</span><span class="token function">setNewstime<span class="token punctuation">(</span></span>time<span class="token punctuation">.</span><span class="token function">get<span class="token punctuation">(</span></span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                list<span class="token punctuation">.</span><span class="token function">add<span class="token punctuation">(</span></span>newsItem<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> list<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>

<p>更多博客尽在：<a href="http://bboylin.com">bboylin.com</a></p>
<!-- content end -->
</div>
<br>
<br>
    <div id="disqus_thread"></div>
	<div class="footer">
		<p>© Copyright 2014 by isnowfy, Designed by isnowfy</p>
	</div>
</div>
<script src="main.js"></script>
<script id="content" type="text/mustache">
    <h1>{{title}}</h1>
    <div class="tag">
    {{date}}
    {{#tags}}
    <a href="/#/tag/{{name}}">#{{name}}</a>
    {{/tags}}
    </div>
</script>
<script id="pagesTemplate" type="text/mustache">
    {{#pages}}
    <li>
        <a href="{{path}}">{{title}}</a>
    </li>
    {{/pages}}
</script>
<script>
$(document).ready(function() {
    $.ajax({
        url: "main.json",
        type: "GET",
        dataType: "json",
        success: function(data) {
            $("#title").html(data.name);
            var pagesTemplate = Hogan.compile($("#pagesTemplate").html());
            var pagesHtml = pagesTemplate.render({"pages": data.pages});
            $("#pages").append(pagesHtml);
            //path
            var path = "loadmore.html";
            //path end
            var now = 0;
            for (var i = 0; i < data.posts.length; ++i)
                if (path == data.posts[i].path)
                    now = i;
            var post = data.posts[now];
            var tmp = post.tags.split(" ");
            var tags = [];
            for (var i = 0; i < tmp.length; ++i)
                if (tmp[i].length > 0)
                    tags.push({"name": tmp[i]});
            var contentTemplate = Hogan.compile($("#content").html());
            var contentHtml = contentTemplate.render({"title": post.title, "tags": tags, "date": post.date});
            $("#main").prepend(contentHtml);
            if (data.disqus_shortname.length > 0) {
                var disqus_shortname = data.disqus_shortname;
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            }
        }
    });
});
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ["\\(", "\\)"]], processEscapes: true}});
</script>
</body>
</html>
